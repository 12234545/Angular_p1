<!-- Page de chatbot en plein écran -->
<div class="full-chatbot-container">
  <!-- Barre latérale pour l'historique -->
  <div class="sidebar" [ngClass]="{'collapsed': sidebarCollapsed}">
    <!-- En-tête de la barre latérale -->
    <div class="sidebar-header">
      <!-- Titre qui sera masqué quand la sidebar est réduite -->
      <div class="header-title">Conversations</div>
      <button class="action-button" (click)="toggleSidebar()" aria-label="Réduire">
        <i class="pi" [ngClass]="sidebarCollapsed ? 'pi-angle-right' : 'pi-angle-left'"></i>
      </button>
    </div>

    <!-- Bouton pour nouvelle conversation -->
    <div class="new-chat-button" (click)="startNewChat()">
      <i class="pi pi-plus"></i>
      <span>Nouvelle conversation</span>
    </div>

    <!-- Liste des conversations -->
    <div class="conversation-history">
      <div *ngFor="let convo of conversations; let i = index"
           class="history-item"
           [ngClass]="{'active': currentConversationIndex === i}"
           (click)="selectConversation(i)">
        <div class="history-content" *ngIf="!sidebarCollapsed">
          <div class="history-title">{{ convo.title }}</div>
          <div class="history-preview">{{ convo.preview }}</div>
          <div class="history-date">{{ convo.date | date:'dd/MM/yyyy' }}</div>
        </div>
        <div class="history-icon" *ngIf="sidebarCollapsed">
          <i class="pi pi-comments"></i>
        </div>
      </div>
    </div>
  </div>

  <!-- Zone principale du chat -->
  <div class="main-chat-area">
    <!-- En-tête du chatbot -->
    <div class="chat-header">
      <div class="header-left">
        <button class="menu-button" (click)="toggleSidebar()" *ngIf="sidebarCollapsed">
          <i class="pi pi-bars"></i>
        </button>
        <div class="header-avatar">
          <img src="pictures/chat.png">
        </div>
        <div class="header-title">Formito</div>
      </div>
      <div class="header-actions">
        <button class="action-button" (click)="clearChat()" aria-label="Effacer la conversation">
          <i class="pi pi-trash"></i>
        </button>
        <button class="action-button" routerLink="/" aria-label="Retour à l'accueil">
          <i class="pi pi-home"></i>
        </button>
      </div>
    </div>

    <!-- Le reste du code reste identique -->
    <!-- Zone des messages -->
    <div class="chat-messages" #messagesContainer>
      <div *ngFor="let msg of currentMessages"
           [ngClass]="{'user-message': msg.sender === 'user', 'bot-message': msg.sender === 'bot'}">
        <div class="message-content">
          <div *ngIf="msg.sender === 'bot'" class="avatar-container">
            <div class="bot-avatar">
              <i class="pi pi-comments"></i>
            </div>
          </div>
          <div class="message-text">
            {{ msg.text }}
          </div>
          <div *ngIf="msg.sender === 'user'" class="avatar-container">
            <div class="user-avatar">
              <i class="pi pi-user"></i>
            </div>
          </div>
        </div>
      </div>

      <!-- Indicateur de chargement -->
      <div *ngIf="loading" class="bot-message">
        <div class="message-content">
          <div class="avatar-container">
            <div class="bot-avatar">
              <i class="pi pi-comments"></i>
            </div>
          </div>
          <div class="typing-indicator">
            <span></span>
            <span></span>
            <span></span>
          </div>
        </div>
      </div>
    </div>

    <!-- Zone de saisie -->
    <div class="chat-input">
      <div class="input-container">
        <input type="text"
               [(ngModel)]="newMessage"
               placeholder="Tapez votre message ici..."
               (keyup.enter)="sendMessage()"
               class="message-input" />
        <button class="send-button" (click)="sendMessage()" [disabled]="loading || !newMessage.trim()">
          <i class="pi pi-send"></i>
        </button>
      </div>
    </div>
  </div>
</div>
